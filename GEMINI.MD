# GEMINI.MD - Contexto Global do Projeto: Bem-Querer Hub

## 1. Vis√£o Geral do Produto

O **Bem-Querer Hub** √© uma plataforma SaaS B2B "Middleware" projetada para centralizar o atendimento, vendas e gest√£o de relacionamento em cl√≠nicas odontol√≥gicas (com foco inicial em Odontopediatria).

O sistema atua como o "c√©rebro comercial", preenchendo a lacuna entre a aquisi√ß√£o de leads (Ads) e o software de gest√£o cl√≠nica (Clinicorp), eliminando a "tela dupla" e automatizando o funil.

### O Fluxo "Connect-Engage-Convert":
1.  **Centralize (Omnichannel):** Agrega m√∫ltiplas inst√¢ncias de WhatsApp via **UazAPI**, permitindo m√∫ltiplos atendentes no mesmo n√∫mero e identifica√ß√£o de origem de Leads (UTMs).
2.  **Qualify (AI Triagem):** O **Google Gemini 2.0** atua como uma "Recepcionista Virtual Emp√°tica", identificando inten√ß√µes (Emerg√™ncia vs. D√∫vida) e extraindo dados (Nome M√£e vs. Nome Filho).
3.  **Sync (Integra√ß√£o):** Sincroniza√ß√£o bidirecional com o Clinicorp para checar disponibilidade de agenda e confirmar status de agendamentos.
4.  **Recover (Automa√ß√£o):** Fluxos de recupera√ß√£o de No-Shows baseados nos status de mensagem (Lido/N√£o Respondido) fornecidos pela UazAPI.

**Slogan:** *"Mais sorrisos, menos telas. A intelig√™ncia que sua recep√ß√£o precisa."*

## 2. Stack Tecnol√≥gica

* **Frontend (Web/Dashboard):** React 18 (Vite) + TailwindCSS + ShadCN/UI + React Query (Cache & State).
* **Chat Engine (Gateway):** **UazAPI** (Integra√ß√£o via REST e Webhooks).
    * *Fun√ß√£o:* Garantir conex√£o est√°vel com WhatsApp (WABA/Baileys) e evitar banimentos.
* **Backend:** Python 3.11+ com framework **FastAPI** (Alta performance para IA e processamento ass√≠ncrono de Webhooks).
* **Database:** PostgreSQL 15+ (Arquitetura Multi-tenant com Row-Level Security).
* **Vector Database:** PGVector (Integrado ao Postgres) para mem√≥ria de longo prazo da IA (RAG).
* **AI Engine:** Google Gemini 2.0 Flash (Baixa lat√™ncia para respostas em tempo real).
* **Infraestrutura:** Docker & Docker Compose (Ambiente AWS ou DigitalOcean).

## 3. Diretrizes de Desenvolvimento (Best Practices)

1.  **Arquitetura Multi-Tenant R√≠gida:**
    * **Mandat√≥rio:** Todas as tabelas cr√≠ticas (`patients`, `chats`, `appointments`) devem ter a coluna `clinic_id`.
    * Middleware de seguran√ßa no FastAPI deve injetar o `clinic_id` automaticamente no contexto da requisi√ß√£o.
2.  **Integra√ß√£o com UazAPI (Webhook Pattern):**
    * **Idempot√™ncia:** O endpoint `/webhook/whatsapp` deve estar preparado para receber eventos duplicados sem criar mensagens repetidas.
    * **Fila de Processamento:** Receber o evento -> Jogar na Fila (Redis/Celery) -> Responder `200 OK` imediatamente para evitar timeout da API.
3.  **Abordagem "Human-in-the-Loop" (Copilot):**
    * A IA sugere o rascunho da resposta, o humano aprova/edita.
    * **Zero Alucina√ß√£o Cl√≠nica:** System Prompt r√≠gido proibindo diagn√≥sticos m√©dicos ou prescri√ß√µes.
4.  **Esteira CI/CD (DevOps):**
    * Pipeline automatizado: Linting (Ruff) -> Unit Tests (Pytest) -> Build Docker -> Deploy.
    * Ambientes segregados: `Staging` (Homologa√ß√£o) vs `Production`.

## 4. Design System & Identidade Visual

Est√©tica **"Pediatric Soft-Tech"**: acolhedora, eficiente e profissional.

### Identidade
* **Tipografia UI:** *Nunito* (Legibilidade amig√°vel).
* **Tipografia Dados:** *Roboto Mono* (IDs, Financeiro, Datas).

### Paleta de Cores Oficial

| Nome da Cor | HEX | Uso Obrigat√≥rio | Contexto |
| :--- | :--- | :--- | :--- |
| **Bem-Querer Blue** | `#00A3E0` | Header, Destaques | Confian√ßa, Marca principal. |
| **Soft Lilac** | `#E0D7F5` | Fundos de Chat | Tecnologia suave, Materno. |
| **Sales Purple** | `#8B5CF6` | Tags "Venda" | Sucesso comercial. |
| **Urgent Coral** | `#FF6B6B` | Tags "Emerg√™ncia" | Alerta visual imediato. |
| **WhatsApp Green**| `#25D366` | √çcone UazAPI/Status | Conex√£o ativa. |
| **Canvas White** | `#F9FAFB` | Fundo Geral | Limpeza visual. |
| **Text Slate** | `#334155` | Textos principais | Contraste suave. |

## 5. Padr√µes de Resposta da IA (Prompt Engineering)

Ao interagir com o Gemini:

* **Persona:** "Voc√™ √© a Carol, assistente virtual da Bem-Querer Odontologia. Seu tom √© emp√°tico, acolhedor e eficiente. Voc√™ fala com m√£es preocupadas ou pacientes ocupados."
* **Estrutura de Sa√≠da (Tools):** Retornar JSON para a√ß√µes do Frontend. Ex: `{"action": "show_calendar", "intent": "booking"}`.
* **Contexto UazAPI:** A IA deve entender que √°udios s√£o transcritos e deve responder em texto curto, simulando naturalidade.

### üë• Nossos Especialistas (Agents.md)

Estes s√£o os perfis de agente especializados para invocar durante o desenvolvimento:

#### **@ProductManager (PM)**
* **Foco:** M√©tricas de Funil, Integra√ß√£o Clinicorp, UX da Recep√ß√£o.
* **Miss√£o:** Validar se os status de mensagem da UazAPI (Sent, Delivered, Read) est√£o atualizando corretamente o Kanban.

#### **@TechLead (Arch)**
* **Foco:** FastAPI, Webhooks UazAPI, Seguran√ßa de Dados (LGPD).
* **Miss√£o:** Garantir rota√ß√£o de tokens, seguran√ßa da API e tratamento de erros de desconex√£o (QR Code caiu).

#### **@FrontendLead (UX)**
* **Foco:** React, Interface de Chat (Clone WhatsApp Web otimizado), Mobile-First.
* **Miss√£o:** Criar alertas visuais claros quando a UazAPI estiver desconectada ou quando houver erro de sincronia com Clinicorp.

#### **@AIEngineer (Gemini)**
* **Foco:** Prompt Tuning, RAG (Busca em conv√™nios), Tratamento de Alucina√ß√µes.
* **Miss√£o:** Garantir que a IA n√£o entre em loops de conversa e saiba transbordar para humano em casos complexos.

#### **@QA_Specialist**
* **Foco:** Testes E2E, Testes de Carga em Webhooks.
* **Miss√£o:** Simular picos de mensagens (Black Friday) para garantir que a fila de processamento n√£o trave o atendimento.